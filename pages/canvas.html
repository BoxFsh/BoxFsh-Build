<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Canvas | BoxFsh</title>
  <!-- IMPORTANT: if this file is inside /pages, the CSS path is ../styles.css -->
  <link rel="stylesheet" href="../styles.css" />
</head>

<body class="bg-slate-900 text-slate-100 min-h-screen">
  <!-- Top bar -->
  <header class="w-full border-b border-slate-800 bg-slate-950/70 backdrop-blur sticky top-0 z-40">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="../index.html" class="text-xl font-bold tracking-wide">BOXFSH</a>
      <nav class="flex items-center gap-4 text-sm">
        <a href="../index.html" class="opacity-70 hover:opacity-100">Home</a>
        <a href="./listing.html" class="opacity-70 hover:opacity-100">Listings</a>
        <a href="./dashboard.html" class="opacity-70 hover:opacity-100">Dashboard</a>
        <span class="px-3 py-1 rounded-full bg-emerald-600/20 text-emerald-300 border border-emerald-700/30">Canvas</span>
      </nav>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6 grid grid-cols-12 gap-4">
    <!-- Left: main workspace -->
    <section class="col-span-12 lg:col-span-9 space-y-4">
      <!-- Milestone track -->
      <div class="rounded-xl border border-slate-800 bg-slate-950/50 p-3">
        <div class="flex items-center justify-between gap-2 text-xs">
          <div class="flex items-center gap-2">
            <span class="px-2 py-1 rounded bg-slate-800 border border-slate-700">Kickoff</span>
            <span class="px-2 py-1 rounded bg-slate-800 border border-slate-700">In Progress</span>
            <span class="px-2 py-1 rounded bg-slate-800 border border-slate-700">Review</span>
            <span class="px-2 py-1 rounded bg-slate-800 border border-slate-700">Complete</span>
          </div>
          <button id="mark-complete" class="px-3 py-1 rounded bg-emerald-600 hover:bg-emerald-500 transition">
            Mark Complete
          </button>
        </div>
      </div>

      <!-- Tabs -->
      <div class="rounded-xl border border-slate-800 bg-slate-950/50">
        <div class="flex flex-wrap items-center gap-2 border-b border-slate-800 p-2">
          <button data-tab="tab-canvas" class="tab-btn active px-3 py-2 rounded-lg bg-slate-800 border border-slate-700">Canvas</button>
          <button data-tab="tab-chat"   class="tab-btn px-3 py-2 rounded-lg hover:bg-slate-800 border border-slate-700/50">Chat</button>
          <button data-tab="tab-files"  class="tab-btn px-3 py-2 rounded-lg hover:bg-slate-800 border border-slate-700/50">Files</button>
          <button data-tab="tab-scope"  class="tab-btn px-3 py-2 rounded-lg hover:bg-slate-800 border border-slate-700/50">Scope</button>
        </div>

        <!-- Canvas tab -->
        <div id="tab-canvas" class="tab-panel p-3 grid grid-cols-12 gap-3">
          <!-- Tool Dock (only visible on Canvas tab) -->
          <aside class="col-span-12 md:col-span-3 space-y-3">
            <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-3">
              <div class="font-semibold mb-2">Tools</div>
              <label class="flex items-center gap-2 text-sm">
                <input type="checkbox" class="tool-toggle" data-target="#sketchpad" checked />
                <span>Sketchpad (placeholder)</span>
              </label>
              <label class="flex items-center gap-2 text-sm">
                <input type="checkbox" class="tool-toggle" data-target="#viewer3d" />
                <span>3D Viewer (placeholder)</span>
              </label>
              <label class="flex items-center gap-2 text-sm">
                <input type="checkbox" class="tool-toggle" data-target="#notes" />
                <span>Notes (sticky)</span>
              </label>
            </div>

            <div class="rounded-lg border border-slate-800 bg-slate-900/60 p-3">
              <div class="font-semibold mb-2">Project Actions</div>
              <button class="w-full mb-2 px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-500 transition">Request Review</button>
              <button class="w-full px-3 py-2 rounded bg-rose-600/20 text-rose-300 border border-rose-700/40 hover:bg-rose-600/30 transition">Flag Issue</button>
            </div>
          </aside>

          <!-- Work Area -->
          <div class="col-span-12 md:col-span-9 space-y-3">
            <!-- File lock banner -->
            <div id="file-lock" class="rounded-lg border border-amber-700/40 bg-amber-900/20 p-3 text-amber-200 text-sm">
              ðŸ”’ Files are locked until the job is marked complete. Previews may be watermarked.
            </div>

            <!-- Sketchpad placeholder -->
            <div id="sketchpad" class="rounded-xl border border-slate-800 bg-slate-900/60 p-3 h-64 grid place-items-center">
              <div class="opacity-70 text-sm">Sketchpad placeholder â€” coming soon</div>
            </div>

            <!-- 3D viewer placeholder (hidden by default) -->
            <div id="viewer3d" class="hidden rounded-xl border border-slate-800 bg-slate-900/60 p-3 h-48 grid place-items-center">
              <div class="opacity-70 text-sm">3D Viewer placeholder â€” supports STL/OBJ/STEP/IGES/GLB/DXF (future)</div>
            </div>

            <!-- Notes (hidden by default) -->
            <div id="notes" class="hidden rounded-xl border border-slate-800 bg-slate-900/60 p-3">
              <textarea class="w-full h-32 bg-slate-950/60 border border-slate-800 rounded p-2 text-sm" placeholder="Quick notes..."></textarea>
            </div>
          </div>
        </div>

        <!-- Chat tab -->
        <div id="tab-chat" class="tab-panel hidden p-3">
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3 h-64 flex flex-col">
            <div class="flex-1 overflow-y-auto space-y-2 pr-1">
              <div class="text-xs opacity-70">No messages yet.</div>
            </div>
            <div class="mt-3 flex items-center gap-2">
              <input class="flex-1 rounded bg-slate-950/60 border border-slate-800 p-2 text-sm" placeholder="Type a message..."/>
              <button class="px-3 py-2 rounded bg-emerald-600 hover:bg-emerald-500 text-sm">Send</button>
            </div>
          </div>
        </div>

        <!-- Files tab -->
        <div id="tab-files" class="tab-panel hidden p-3">
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3">
            <div class="text-sm opacity-80 mb-2">Locked until completion.</div>
            <ul class="text-sm list-disc ml-6 space-y-1 opacity-60">
              <li>final_model.glb (locked)</li>
              <li>print_settings.json (locked)</li>
              <li>preview.png (watermarked)</li>
            </ul>
          </div>
        </div>

        <!-- Scope tab -->
        <div id="tab-scope" class="tab-panel hidden p-3">
          <div class="rounded-xl border border-slate-800 bg-slate-900/60 p-3 space-y-2 text-sm">
            <div class="font-semibold">Job Scope</div>
            <p class="opacity-80">Imported after job acceptance. Changes require both parties to re-confirm.</p>
            <label class="flex items-center gap-2 mt-2 text-xs opacity-80">
              <input type="checkbox" /> I confirm Iâ€™ve read and accept the agreed scope.
            </label>
          </div>
        </div>
      </div>
    </section>

    <!-- Right: comments / activity -->
    <aside class="col-span-12 lg:col-span-3 space-y-4">
      <div class="rounded-xl border border-slate-800 bg-slate-950/50 p-3">
        <div class="font-semibold mb-2">Comment Log</div>
        <div id="comment-log" class="space-y-2 text-sm max-h-72 overflow-y-auto pr-1">
          <div class="opacity-70">No comments yet.</div>
        </div>
        <div class="mt-3 flex items-center gap-2">
          <input id="comment-input" class="flex-1 rounded bg-slate-950/60 border border-slate-800 p-2 text-sm" placeholder="Add a comment..."/>
          <button id="comment-add" class="px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-500 text-sm">Add</button>
        </div>
      </div>

      <div class="rounded-xl border border-slate-800 bg-slate-950/50 p-3">
        <div class="font-semibold mb-2">Project Info</div>
        <ul class="text-xs opacity-80 space-y-1">
          <li>Job #: BF-2025-0001</li>
          <li>Status: In Progress</li>
          <li>Customer: J. Smith</li>
          <li>Pro: You</li>
        </ul>
      </div>
    </aside>
  </main>

  <footer class="max-w-6xl mx-auto px-4 py-8 opacity-70 text-xs">
    Â© BoxFsh â€” All activity is logged and moderated.
  </footer>

  <script src="../scripts/canvas.js" defer></script>
</body>
</html>
<script>
  // Simple tab switching logic
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const targetTab = btn.getAttribute('data-tab');
      document.querySelectorAll('.tab-panel').forEach(panel => {
        panel.classList.toggle('hidden', panel.id !== targetTab);
      });
    });
  });

  // Tool toggle functionality
  document.querySelectorAll('.tool-toggle').forEach(toggle => {
    toggle.addEventListener('change', () => {
      const target = document.querySelector(toggle.getAttribute('data-target'));
      target.classList.toggle('hidden', !toggle.checked);
    });
  });

  // Mark complete button
  document.getElementById('mark-complete').addEventListener('click', () => {
    alert('Job marked as complete!');
    // Additional logic to handle completion can be added here
  });

  // Comment log functionality
  const commentLog = document.getElementById('comment-log');
  const commentInput = document.getElementById('comment-input');
  const commentAdd = document.getElementById('comment-add');

  commentAdd.addEventListener('click', () => {
    const text = commentInput.value.trim();
    if (text) {
      const newComment = document.createElement('div');
      newComment.textContent = text;
      commentLog.appendChild(newComment);
      commentInput.value = '';
    }
  });